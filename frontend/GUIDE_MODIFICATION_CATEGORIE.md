# âœï¸ Guide : Modification de CatÃ©gories

## ğŸ“‹ Vue d'ensemble

L'utilisateur peut maintenant **modifier (renommer) une catÃ©gorie** directement depuis la liste en onglet "GÃ©rer".

---

## ğŸ¨ Interface de modification

### **Liste des catÃ©gories avec boutons**

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ“‹ Liste des catÃ©gories                            â”‚
    â”‚                                                    â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚ â”‚ Boissons      (3 produits)  [âœï¸] [ğŸ—‘ï¸]       â”‚  â”‚
    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚ â”‚ Snacks        (2 produits)  [âœï¸] [ğŸ—‘ï¸]       â”‚  â”‚
    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚ â”‚ Alimentaire   (5 produits)  [âœï¸] [ğŸ—‘ï¸]       â”‚  â”‚
    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚ â”‚ HygiÃ¨ne       (1 produit)   [âœï¸] [ğŸ—‘ï¸]       â”‚  â”‚
    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚ â”‚ Ã‰lectronique  (0 produits)  [âœï¸] [ğŸ—‘ï¸]       â”‚  â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Boutons:
    [âœï¸] = Modifier   (Bleu)
    [ğŸ—‘ï¸] = Supprimer (Rouge)
```

---

## ğŸ”„ Processus de modification

### **Ã‰tape 1: Cliquer sur le bouton "âœï¸ Modifier"**

```
Utilisateur clique sur [âœï¸] Ã  cÃ´tÃ© de "Boissons"
         â†“
La ligne se transforme pour Ã©dition:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ [  Boissons          ] [âœ“] [âœ•]                   â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚                   â”‚
    â”‚            Input       Save Cancel                â”‚
    â”‚         avec FOCUS                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ã‰tat visuel:**
- Input apparaÃ®t avec le nom actuel
- Nom actuel sÃ©lectionnÃ© (ready to edit)
- Input reÃ§oit le focus automatiquement
- Boutons originaux masquÃ©s
- Deux nouveaux boutons: âœ“ (Sauvegarder) et âœ• (Annuler)

---

### **Ã‰tape 2: Modifier le nom**

```
Utilisateur efface "Boissons" et saisit "Boissons et Jus"
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ [  Boissons et Jus  ] [âœ“] [âœ•]                   â”‚
    â”‚                      PrÃªt Ã  sauvegarder         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**En temps rÃ©el:**
- Texte s'affiche dans l'input
- Peut supprimer/ajouter du texte
- Le formulaire est prÃªt Ã  Ãªtre sauvegardÃ©

---

### **Ã‰tape 3a: Cliquer "âœ“ Sauvegarder"**

```
Utilisateur clique sur âœ“ (Vert)
         â†“
Validation du nouveau nom:
  1ï¸âƒ£  Non-vide? âœ… OK
  2ï¸âƒ£  Pas identique au prÃ©cÃ©dent? âœ… OK
  3ï¸âƒ£  Pas un doublon? âœ… OK
         â†“
Modification acceptÃ©e:
  âœ“ Nom changÃ© dans categoriesData
  âœ“ Tous les produits "Boissons" â†’ "Boissons et Jus"
  âœ“ Selects mis Ã  jour
  âœ“ Liste rafraÃ®chie
         â†“
Notification affichÃ©e:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âœ“ CatÃ©gorie "Boissons" renommÃ©e en       â”‚
    â”‚    "Boissons et Jus"                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       (Vert - SuccÃ¨s - 3-4 sec)
         â†“
Liste mise Ã  jour:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ [Boissons et Jus] (3 produits) [âœï¸] [ğŸ—‘ï¸]      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Ã‰tape 3b: Cliquer "âœ• Annuler"**

```
Utilisateur clique sur âœ• (Gris)
         â†“
Ã‰dition annulÃ©e:
  âœ— Rien n'est modifiÃ©
  âœ— Les donnÃ©es restent inchangÃ©es
  âœ— Pas de notification
         â†“
La ligne revient Ã  son Ã©tat normal:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Boissons      (3 produits)  [âœï¸] [ğŸ—‘ï¸]         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ Cas d'erreur

### **Cas 1: Champ vide**

```
Utilisateur efface tout et clique âœ“
         â†“
Notification erreur:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âŒ Veuillez entrer un nom     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**RÃ©sultat:**
- âŒ Modification non sauvegardÃ©e
- âŒ Input reste visible
- âŒ L'utilisateur peut rÃ©essayer

---

### **Cas 2: Nom identique**

```
Utilisateur clique âœ“ sans modifier le texte
         â†“
SystÃ¨me dÃ©tecte: "Boissons" === "Boissons"
         â†“
Annulation automatique:
         â†“
La ligne revient Ã  son Ã©tat normal
Pas de notification
```

---

### **Cas 3: CatÃ©gorie en doublon**

```
Utilisateur change "Boissons" en "Snacks" (existe dÃ©jÃ )
         â†“
Validation Ã©choue: Doublon dÃ©tectÃ©
         â†“
Notification erreur:
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âŒ Cette catÃ©gorie existe     â”‚
    â”‚     dÃ©jÃ                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**RÃ©sultat:**
- âŒ Modification non sauvegardÃ©e
- âŒ Input reste avec "Snacks"
- âŒ L'utilisateur peut modifier

---

## ğŸ”§ Code JavaScript - Fonctions

### **1. DÃ©marrer la modification**

```javascript
function demarrerModificationCategorie(index, ancienNom) {
    const item = document.getElementById(`categorie-item-${index}`);
    const nomSpan = document.getElementById(`nom-categorie-${index}`);
    const actionsDiv = item.querySelector('.categorie-actions');
    
    // CrÃ©er l'interface d'Ã©dition
    let html = `
        <div class="categorie-modification">
            <input type="text" 
                   id="input-modif-${index}" 
                   class="input-modification" 
                   value="${ancienNom}">
            <div class="modification-actions">
                <button class="btn-action-mini btn-sauvegarder" 
                        onclick="sauvegarderModificationCategorie('${index}', '${ancienNom}')">
                    <i class="fa-solid fa-check"></i>
                </button>
                <button class="btn-action-mini btn-annuler" 
                        onclick="annulerModificationCategorie('${index}')">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
        </div>
    `;

    // Masquer le nom et les actions
    nomSpan.style.display = 'none';
    actionsDiv.style.display = 'none';
    
    // InsÃ©rer le formulaire de modification
    const modifDiv = document.createElement('div');
    modifDiv.innerHTML = html;
    modifDiv.id = `modif-div-${index}`;
    item.insertBefore(modifDiv.firstElementChild, actionsDiv);
    
    // Focus et sÃ©lection du texte
    const inputModif = document.getElementById(`input-modif-${index}`);
    inputModif.focus();
    inputModif.select();
}
```

### **2. Sauvegarder la modification**

```javascript
function sauvegarderModificationCategorie(index, ancienNom) {
    const inputModif = document.getElementById(`input-modif-${index}`);
    const nouveauNom = inputModif.value.trim();

    // Validation: non-vide
    if (!nouveauNom) {
        afficherNotification('Veuillez entrer un nom de catÃ©gorie', 'error');
        return;
    }

    // Validation: pas identique
    if (nouveauNom.toLowerCase() === ancienNom.toLowerCase()) {
        annulerModificationCategorie(index);
        return;
    }

    // Validation: pas doublon
    if (categoriesData.some(cat => 
        cat.toLowerCase() === nouveauNom.toLowerCase() && 
        cat.toLowerCase() !== ancienNom.toLowerCase())) {
        afficherNotification('Cette catÃ©gorie existe dÃ©jÃ ', 'error');
        return;
    }

    // Trouver et mettre Ã  jour
    const indexData = categoriesData.findIndex(
        cat => cat.toLowerCase() === ancienNom.toLowerCase()
    );
    
    if (indexData !== -1) {
        // 1. Mettre Ã  jour les produits
        produitsData.forEach(produit => {
            if (produit.categorie.toLowerCase() === ancienNom.toLowerCase()) {
                produit.categorie = nouveauNom;
            }
        });

        // 2. Mettre Ã  jour categoriesData
        categoriesData[indexData] = nouveauNom;

        // 3. Mettre Ã  jour les selects
        mettreAJourSelectCategories();

        // 4. Notification
        afficherNotification(
            `CatÃ©gorie "${ancienNom}" renommÃ©e en "${nouveauNom}"`,
            'success'
        );

        // 5. RafraÃ®chir la liste
        afficherListeCategories();
    }
}
```

### **3. Annuler la modification**

```javascript
function annulerModificationCategorie(index) {
    const item = document.getElementById(`categorie-item-${index}`);
    const modifDiv = item.querySelector('.categorie-modification');
    const nomSpan = document.getElementById(`nom-categorie-${index}`);
    const actionsDiv = item.querySelector('.categorie-actions');

    // Supprimer le formulaire de modification
    if (modifDiv) {
        modifDiv.remove();
    }

    // RÃ©afficher le nom et les actions
    nomSpan.style.display = '';
    actionsDiv.style.display = '';
}
```

---

## ğŸ”„ Workflow complet

```
L'utilisateur clique [âœï¸]
       â†“
demarrerModificationCategorie()
       â†“
Convertit la ligne en formulaire d'Ã©dition
       â†“
Input reÃ§oit FOCUS + sÃ©lectionne le texte
       â†“
Utilisateur saisit le nouveau nom
       â†“
Clic sur [âœ“] ou [âœ•]?
       â”œâ”€ [âœ“] â†’ sauvegarderModificationCategorie()
       â”‚        â”œâ”€ Validation (non-vide, doublon, identique)
       â”‚        â”œâ”€ Si OK:
       â”‚        â”‚  â”œâ”€ Update categoriesData
       â”‚        â”‚  â”œâ”€ Update produits associÃ©s
       â”‚        â”‚  â”œâ”€ Update selects
       â”‚        â”‚  â””â”€ Notification succÃ¨s
       â”‚        â””â”€ Si erreur:
       â”‚           â””â”€ Notification erreur (input reste)
       â”‚
       â””â”€ [âœ•] â†’ annulerModificationCategorie()
                â”œâ”€ Supprime formulaire
                â”œâ”€ RÃ©affiche nom et boutons
                â””â”€ Pas de notification
```

---

## ğŸ“Š Tableau des opÃ©rations

| OpÃ©ration | Avant | AprÃ¨s | Produits | Selects |
|-----------|-------|-------|----------|---------|
| Ajouter | N/A | Nouvelle | N/A | âœ… Mis Ã  jour |
| Modifier | "Boissons" | "Boissons et Jus" | âœ… RenommÃ©s | âœ… Mis Ã  jour |
| Supprimer | "Ã‰lec" | N/A | N/A (si 0) | âœ… Mis Ã  jour |

---

## ğŸ¨ Styles CSS

### **Bouton modifier**
- Couleur: Bleu (#007bff)
- Hover: Bleu foncÃ© (#0056b3)
- Icon: âœï¸

### **Input modification**
- Border: 2px solid rouge
- Focus: Shadow rouge clair
- Padding: 8px 12px

### **Boutons mini**
- Sauvegarder: Vert (#28a745)
- Annuler: Gris (#6c757d)
- Size: Plus petit que les autres boutons

---

## ğŸ”’ Validations

| Validation | DÃ©tail |
|-----------|--------|
| **Non-vide** | `if (!nouveauNom)` |
| **IdentitÃ©** | `.toLowerCase() === `.toLowerCase() |
| **Doublon** | `.some(cat => cat.toLowerCase() === nouveauNom)` |
| **Case-insensitive** | Toutes les comparaisons en minuscules |

---

## ğŸ“ Mise Ã  jour de donnÃ©es

**Quand une catÃ©gorie est modifiÃ©e:**

1. âœ… `categoriesData` - Le nom est changÃ©
2. âœ… `produitsData` - Les produits sont renommÃ©s
3. âœ… Select filtre - Mis Ã  jour
4. âœ… Select formulaire - Mis Ã  jour
5. âœ… Liste affichÃ©e - RafraÃ®chie
6. âœ… UI - Revient Ã  l'Ã©tat normal

---

## ğŸš€ Points clÃ©s

| Point | DÃ©tail |
|-------|--------|
| **Localisation** | Onglet "GÃ©rer" de la modale |
| **Bouton** | IcÃ´ne stylo bleu [âœï¸] |
| **Interface** | Inline dans la liste |
| **Confirmation** | [âœ“] et [âœ•] boutons |
| **Auto-focus** | Input reÃ§oit focus automatiquement |
| **Auto-select** | Texte sÃ©lectionnÃ© pour Ã©dition rapide |
| **Notification** | SuccÃ¨s/Erreur affichÃ©e |
| **Validation** | Multiple checks |

---

## ğŸ’¡ AmÃ©liorations futures

1. **Keyboard shortcuts** - Entrer pour sauvegarder, Ã‰chap pour annuler
2. **Confirmation** - Dialog avant modification si produits associÃ©s
3. **Historique** - Log des changements
4. **Batch edit** - Ã‰diter plusieurs Ã  la fois
5. **Suggestive** - Suggestions de noms

